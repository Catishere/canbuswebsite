var can = require('socketcan');
var fs = require('fs');

// Parse database
var network = can.parseNetworkDescription("./test.kcd");

console.log(network.buses)

var c = can.createRawChannel("vcan0");
var d = new can.DatabaseService(c, network.buses['test.kcd']);

c.start();

console.log("Starting simulation " + b);

// Generate all CAN message this node is the producer
for (m in d.messages) {
	var msg = d.messages[m];

	if (msg.interval)
		setInterval(function(name) { d.send(name); }, msg.interval, msg.name);
}
